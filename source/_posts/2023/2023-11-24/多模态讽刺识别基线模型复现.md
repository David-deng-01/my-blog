---
title: 多模态讽刺识别基线模型复现
tags:
  - 基线模型
  - 讽刺识别
  - 论文
categories:
  - 论文
  - 讽刺识别
  - 基线模型
keywords: '论文,讽刺识别,基线模型'
description: 多模态讽刺识别基线模型复现
abbrlink: 16585
date: 2023-11-24 16:51:18
---

# 多模态讽刺识别基线模型复现

## 0. 文章简介

文章名称：[MMSD2.0: Towards a Reliable Multi-modal Sarcasm Detection System](https://aclanthology.org/2023.findings-acl.689/)

原文发表在2023年的 [ACL](https://aclanthology.org/events/acl-2023/) 上的 Findings 中。文章使用"文本-图像对"进行讽刺检测，使用`CLIP`编码器对文本和对象进行特征抽取。使用文本，图像和文本图像融合三种模态进行讽刺检测。

如果觉得文章对您有帮助的话，欢迎引用原文:

```tex
@inproceedings{qin-etal-2023-mmsd2,
    title = "{MMSD}2.0: Towards a Reliable Multi-modal Sarcasm Detection System",
    author = "Qin, Libo  and
      Huang, Shijue  and
      Chen, Qiguang  and
      Cai, Chenran  and
      Zhang, Yudi  and
      Liang, Bin  and
      Che, Wanxiang  and
      Xu, Ruifeng",
    booktitle = "Findings of the Association for Computational Linguistics: ACL 2023",
    month = jul,
    year = "2023",
    address = "Toronto, Canada",
    publisher = "Association for Computational Linguistics",
    url = "https://aclanthology.org/2023.findings-acl.689",
    pages = "10834--10845",
    abstract = "Multi-modal sarcasm detection has attracted much recent attention. Nevertheless, the existing benchmark (MMSD) has some shortcomings that hinder the development of reliable multi-modal sarcasm detection system: (1) There are some spurious cues in MMSD, leading to the model bias learning; (2) The negative samples in MMSD are not always reasonable. To solve the aforementioned issues, we introduce MMSD2.0, a correction dataset that fixes the shortcomings of MMSD, by removing the spurious cues and re-annotating the unreasonable samples. Meanwhile, we present a novel framework called multi-view CLIP that is capable of leveraging multi-grained cues from multiple perspectives (i.e., text, image, and text-image interaction view) for multi-modal sarcasm detection. Extensive experiments show that MMSD2.0 is a valuable benchmark for building reliable multi-modal sarcasm detection systems and multi-view CLIP can significantly outperform the previous best baselines.",
}
```

##  1. 环境准备

### 1.1 环境配置

原文的代码链接：[JoeYing1019/MMSD2.0: Code and dataset for ACL23 Findings paper "MMSD2.0: Towards a Reliable Multi-modal Sarcasm Detection System" (github.com)](https://github.com/JoeYing1019/MMSD2.0)

根据原文代码仓库中的`README.md`和`requirement.txt`，创建代码运行的环境。

作者的代码基于 `PyTorch 1.12 ` 实现，需要依赖的软件包如下:

- numpy==1.21.6
- tqdm==4.64.0
- pytorch==1.12.0
- python==3.7.4
- pillow==9.2.0
- transformers==4.23.1
- wandb==0.13.3
- scikit-learn==1.0.2

作者强烈推荐使用 [Anaconda](https://www.anaconda.com/) 管理和创建 `Python` 环境，可以直接使用下面的命令在终端中直接创建代码运行的环境

```bash
conda create -n env_name python=3.7.4   
source activate env_name     
pip install -r requirements.txt
```



### 1.2 数据集准备

作者使用的数据集链接： [1](https://drive.google.com/file/d/1mK0Nf-jv_h2bgHUCRM4_EsdTiiitZ_Uj/view?usp=sharing_eil&ts=5d480e04) [2](https://drive.google.com/file/d/1AOWzlOz5hmdO39dEmzhQ4z_nabgzi7Tu/view?usp=sharing_eil&ts=5d480e04) [3](https://drive.google.com/file/d/1dJERrVlp7DlNSXk-uvbbG6Rv7uvqTOKd/view?usp=sharing_eil&ts=5d480e04) [4](https://drive.google.com/file/d/1pODuKC4gP6-QDQonG8XTqI8w8ds68mE3/view?usp=sharing_eil&ts=5d480e04) ,下载完成后将数据解压到`data/dataset_image`目录下。

因为是复现基线模型，并且我们的目标是构建数据集，所以直接使用自己构建好的数据集即可，不需要下载作者提供的数据集。

但是使用自己的数据集也存在一些问题，我们需要修改一些原文的代码，才能使得基线模型能够运行在我们自己构建的数据集上。



## 2. 代码复现

## x. 遇到的问题以及解决的方案

### 1. 环境准备

#### 问题描述：

一开始，我直接使用作者推荐的方式，用`Anaconda`构建和管理自己的`Python`环境，但是不出意外的是，出现了很多问题。

总结来说就是：

1. 很多第三方包存在冲突，安装不了
2. `Python 3.7` 和 `Pytorch 1.12` 不兼容

#### 解决方案：

首先，我推荐使用Anaconda创建和管理虚拟环境，如果使用其他方式创建，请自行探索和解决第三方包冲突问题。使用下面的代码创建和激活你的虚拟环境：

```bash
conda create -n env_name python=3.8 
conda  activate env_name     
```

其次，安装依赖，只安装一些必要的依赖，作者提供的`requirement.txt`存在很多不必要的包，所以不需要全部都安装，我只安装了下面这几种包

```bash
pip install numpy tqdm torch torchvision pillow transformers wandb scikit-learn
```



## 参考文献和链接

1. [MMSD2.0: Towards a Reliable Multi-modal Sarcasm Detection System](https://aclanthology.org/2023.findings-acl.689/)
2. [JoeYing1019/MMSD2.0: Code and dataset for ACL23 Findings paper "MMSD2.0: Towards a Reliable Multi-modal Sarcasm Detection System" (github.com)](https://github.com/JoeYing1019/MMSD2.0)
3. [使用python如何截断想要时段的语音并且生成对应的梅尔谱图-音视频开发中文网 (0voice.com)](https://avmedia.0voice.com/?id=42710)
4. [librosa — librosa 0.10.1 documentation](https://librosa.org/doc/latest/index.html)